+++
title = 'Implementing Vga'
date = 2024-04-18T00:31:03Z
draft = true
+++

I'm currently taking a course on Verilog programming, and for one of our weekly assignments we had to implement the Video Graphics Array (VGA) protocol to run in a FPGA and display something to a screen. Since I really liked the experience I'm going to briefly explain how the VGA protocol works, and how you can pretty easily make a VGA controller in verilog.
Before we start, let's clear a few things, all the code was written in Systems Verilog, and compiled on Quartus, to run on an Intel DE1-SoC, I don't know how portable verilog is, and how much one would have to change to run it in another board. Also, this post is not meant to be a verilog tutorial nor a quartus tutorial, the main focus is on the VGA protocol itself, the way you choose to implement andrun it is secondary.
As always with precisely defined protocol, it's always best to read the documentation, in our case, the [DE1-SoC User Manual](https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://www.terasic.com.tw/cgi-bin/page/archive_download.pl%3FLanguage%3DEnglish%26No%3D836%26FID%3Dae336c1d5103cac046279ed1568a8bc3&ved=2ahUKEwjeof6Gw8qFAxUyE7kGHWVYD5gQFnoECBQQAQ&usg=AOvVaw2IylRCvVFE7kxKbR0dpC4K) contains a pretty concise specification of the protocol. If you want you can give that a read, but I will list all the information you need to get started.
The VGA protocol uses analog RGB values, but the DE1-SoC is comprised mostly of digital pins, so it employs a Digital-to-Analog Converter (DAC) to turn the digital 8 bit signal of each color channel into an analog channel. The specific DAC chip is not really important, but if you're curious and want to check out its datasheet, the DE1-SoC uses the ADV7123. Apart from the 3 color channels, the DAC also takes as input the VGA clock, and two auxiliary signals: BLANK_N and SYNC_N, which we don't really need to worry about here. And last but not least, the signals HS and VS go straight from the board to the VGA connector.
The protocol uses a simple synchronization mechanism between individual lines and full images. Each image is sent line by line, and every line is sent pixel by pixel, starting from the top-left position in the screen. Each line is preceded by a logic-low pulse of the HS signal, followed by a period where all the signals (including RGB) must be off, called the back porch, and only then the pixels are sent serially, one per clock pulse. After all the 640 pixels have been sent, there is another period where all signals are off called the front porch.
